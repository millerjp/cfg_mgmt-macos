---
- hosts: workstation

  tasks:
    - name: Install iTerm2
      homebrew_cask: name=iterm2
      environment:
        HOMEBREW_CASK_OPTS: "--appdir=/Applications"

    - name: Set iTerm2 settings
      notify: restart iTerm2
      plist_file:
        dest: com.googlecode.iterm2
        value:
          AdjustWindowForFontSizeChange: yes
          AllowClipboardAccess: no
          AnimateDimming: no
          AppleAntiAliasingThreshold: 1
          AppleScrollAnimationEnabled: 0
          AppleSmoothFixedFontsSizeThreshold: 1
          AutoHideTmuxClientSession: no
          CheckTestRelease: yes
          ClosingHotkeySwitchesSpaces: yes
          CommandSelection: yes
          Control: 1
          CopyLastNewline: no
          CopySelection: yes
          DimBackgroundWindows: no
          DimInactiveSplitPanes: yes
          DimOnlyText: no
          DisableFullscreenTransparency: no
          EnableRendezvous: no
          FocusFollowsMouse: no
          FsTabDelay: 1
          HiddenAFRStrokeThickness: 0
          HiddenAdvancedFontRendering: no
          HideActivityIndicator: no
          HideMenuBarInFullscreen: yes
          HideScrollbar: no
          HideTab: yes
          HighlightTabLabels: yes
          HotKeyBookmark: 978C3E4B-2AE4-49B4-AFC1-F21C19B2B74B
          HotKeyTogglesWindow: no
          Hotkey: no
          HotkeyChar: 0
          HotkeyCode: 0
          HotkeyModifiers: 0
          IRMemory: 4
          JobName: yes
          LeftCommand: 7
          LeftOption: 2
          LoadPrefsFromCustomFolder: no
          MaxVertically: no
          NSColorPanelMode: 13370000
          NSQuotedKeystrokeBinding: ""
          NSRepeatCountBinding: ""
          NSScrollAnimationEnabled: no
          NSToolbar Configuration com.apple.NSColorPanel:
            TB Is Shown: 1
          NeverWarnAboutShortLivedSessions_978C3E4B-2AE4-49B4-AFC1-F21C19B2B74B: yes
          NoSyncTimeOfLastPromo: 457429295.509115
          NoSyncTimeOfLastPromoDownload: 465813093.240649
          OnlyWhenMoreTabs: yes
          OpenArrangementAtStartup: no
          OpenBookmark: no
          OpenTmuxWindowsIn: 0
          PassOnControlClick: no
          PasteFromClipboard: no
          PrefsCustomFolder: ""
          PromptOnQuit: yes
          QuitWhenAllWindowsClosed: yes
          RightCommand: 8
          RightOption: 3
          SUEnableAutomaticChecks: yes
          SUFeedURL: https://iterm2.com/appcasts/testing.xml
          SUHasLaunchedBefore: yes
          SavePasteHistory: no
          ShowBookmarkName: no
          ShowPaneTitles: yes
          SkalaPickerTextColourFormat: 4
          SmartPlacement: no
          SplitPaneDimmingAmount: 0.4
          SwitchTabModifier: 4
          SwitchWindowModifier: 6
          TabViewType: 0
          ThreeFingerEmulates: no
          TmuxDashboardLimit: 10
          TripleClickSelectsFullWrappedLines: no
          UKCrashReporterLastCrashReportDate: 1.437843e+09
          URLHandlersByGuid:
          UseBorder: no
          UseCompactLabel: yes
          UseLionStyleFullscreen: yes
          WebKitDefaultFontSize: 11
          WebKitStandardFont: .AppleSystemUIFont
          WindowNumber: yes
          WindowStyle: 0
          WordCharacters: /-+\~_.
          findIgnoreCase_iTerm: yes
          findRegex_iTerm: no
          iTerm Version: 2.1.4

          PointerActions:
            Button,1,1,,:
              Action: kContextMenuPointerAction
            Button,2,1,,:
              Action: kPasteFromClipboardPointerAction
            Gesture,ThreeFingerSwipeDown,,:
              Action: kPrevWindowPointerAction
            Gesture,ThreeFingerSwipeLeft,,:
              Action: kPrevTabPointerAction
            Gesture,ThreeFingerSwipeRight,,:
              Action: kNextTabPointerAction
            Gesture,ThreeFingerSwipeUp,,:
              Action: kNextWindowPointerAction

          GlobalKeyMap:
            0x19-0x60000:
              Action: 2
              Text: ""
            0x9-0x40000:
              Action: 0
              Text: ""
            0xf700-0x300000:
              Action: 7
              Text: ""
            0xf701-0x300000:
              Action: 6
              Text: ""
            0xf702-0x300000:
              Action: 2
              Text: ""
            0xf702-0x320000:
              Action: 33
              Text: ""
            0xf703-0x300000:
              Action: 0
              Text: ""
            0xf703-0x320000:
              Action: 34
              Text: ""
            0xf729-0x100000:
              Action: 5
              Text: ""
            0xf72b-0x100000:
              Action: 4
              Text: ""
            0xf72c-0x100000:
              Action: 9
              Text: ""
            0xf72c-0x20000:
              Action: 9
              Text: ""
            0xf72d-0x100000:
              Action: 8
              Text: ""
            0xf72d-0x20000:
              Action: 8
              Text: ""

          Custom Color Presets:
            base16-default.dark.256:
              Ansi 0 Color:
                Blue Component: 0.09411764705882353
                Color Space: sRGB
                Green Component: 0.09411764705882353
                Red Component: 0.09411764705882353
              Ansi 1 Color:
                Blue Component: 0.2588235294117647
                Color Space: sRGB
                Green Component: 0.2745098039215687
                Red Component: 0.6705882352941176
              Ansi 2 Color:
                Blue Component: 0.4235294117647059
                Color Space: sRGB
                Green Component: 0.7098039215686275
                Red Component: 0.6313725490196078
              Ansi 3 Color:
                Blue Component: 0.5333333333333333
                Color Space: sRGB
                Green Component: 0.792156862745098
                Red Component: 0.9686274509803922
              Ansi 4 Color:
                Blue Component: 0.7607843137254902
                Color Space: sRGB
                Green Component: 0.6862745098039216
                Red Component: 0.4862745098039216
              Ansi 5 Color:
                Blue Component: 0.6862745098039216
                Color Space: sRGB
                Green Component: 0.5450980392156862
                Red Component: 0.7294117647058823
              Ansi 6 Color:
                Blue Component: 0.7254901960784313
                Color Space: sRGB
                Green Component: 0.7568627450980392
                Red Component: 0.5254901960784314
              Ansi 7 Color:
                Blue Component: 0.8470588235294118
                Color Space: sRGB
                Green Component: 0.8470588235294118
                Red Component: 0.8470588235294118
              Ansi 8 Color:
                Blue Component: 0.3450980392156863
                Color Space: sRGB
                Green Component: 0.3450980392156863
                Red Component: 0.3450980392156863
              Ansi 9 Color:
                Blue Component: 0.2588235294117647
                Color Space: sRGB
                Green Component: 0.2745098039215687
                Red Component: 0.6705882352941176
              Ansi 10 Color:
                Blue Component: 0.4235294117647059
                Color Space: sRGB
                Green Component: 0.7098039215686275
                Red Component: 0.6313725490196078
              Ansi 11 Color:
                Blue Component: 0.5333333333333333
                Color Space: sRGB
                Green Component: 0.792156862745098
                Red Component: 0.9686274509803922
              Ansi 12 Color:
                Blue Component: 0.7607843137254902
                Color Space: sRGB
                Green Component: 0.6862745098039216
                Red Component: 0.4862745098039216
              Ansi 13 Color:
                Blue Component: 0.6862745098039216
                Color Space: sRGB
                Green Component: 0.5450980392156862
                Red Component: 0.7294117647058823
              Ansi 14 Color:
                Blue Component: 0.7254901960784313
                Color Space: sRGB
                Green Component: 0.7568627450980392
                Red Component: 0.5254901960784314
              Ansi 15 Color:
                Blue Component: 0.9725490196078431
                Color Space: sRGB
                Green Component: 0.9725490196078431
                Red Component: 0.9725490196078431
              Background Color:
                Blue Component: 0.09411764705882353
                Color Space: sRGB
                Green Component: 0.09411764705882353
                Red Component: 0.09411764705882353
              Bold Color:
                Blue Component: 0.8470588235294118
                Color Space: sRGB
                Green Component: 0.8470588235294118
                Red Component: 0.8470588235294118
              Cursor Color:
                Blue Component: 0.8470588235294118
                Color Space: sRGB
                Green Component: 0.8470588235294118
                Red Component: 0.8470588235294118
              Cursor Text Color:
                Blue Component: 0.09411764705882353
                Color Space: sRGB
                Green Component: 0.09411764705882353
                Red Component: 0.09411764705882353
              Foreground Color:
                Blue Component: 0.8470588235294118
                Color Space: sRGB
                Green Component: 0.8470588235294118
                Red Component: 0.8470588235294118
              Selected Text Color:
                Blue Component: 0.8470588235294118
                Color Space: sRGB
                Green Component: 0.8470588235294118
                Red Component: 0.8470588235294118
              Selection Color:
                Blue Component: 0.2196078431372549
                Color Space: sRGB
                Green Component: 0.2196078431372549
                Red Component: 0.2196078431372549
            earthsong:
              Ansi 0 Color:
                Blue Component: 0.1294208
                Color Space: sRGB
                Green Component: 0.144692
                Red Component: 0.1564068
              Ansi 1 Color:
                Blue Component: 0.2382512
                Color Space: sRGB
                Green Component: 0.3876701
                Red Component: 0.8158474
              Ansi 2 Color:
                Blue Component: 0.2510209
                Color Space: sRGB
                Green Component: 0.7399791
                Red Component: 0.5202177
              Ansi 3 Color:
                Blue Component: 0.2676881
                Color Space: sRGB
                Green Component: 0.6686236
                Red Component: 0.9481701
              Ansi 4 Color:
                Blue Component: 0.8245208
                Color Space: sRGB
                Green Component: 0.6105703
                Red Component: 0.4368615
              Ansi 5 Color:
                Blue Component: 0.4964534
                Color Space: sRGB
                Green Component: 0.3234674
                Red Component: 0.8150991
              Ansi 6 Color:
                Blue Component: 0.7783818
                Color Space: sRGB
                Green Component: 0.8322567
                Red Component: 0.5439116
              Ansi 7 Color:
                Blue Component: 0.7988065
                Color Space: sRGB
                Green Component: 0.8157431
                Red Component: 0.8288889
              Ansi 8 Color:
                Blue Component: 0.3157758
                Color Space: sRGB
                Green Component: 0.3737666
                Red Component: 0.4055308
              Ansi 9 Color:
                Blue Component: 0.2382512
                Color Space: sRGB
                Green Component: 0.3876701
                Red Component: 0.8158474
              Ansi 10 Color:
                Blue Component: 0.2510209
                Color Space: sRGB
                Green Component: 0.7399791
                Red Component: 0.5202177
              Ansi 11 Color:
                Blue Component: 0.2676881
                Color Space: sRGB
                Green Component: 0.6686236
                Red Component: 0.9481701
              Ansi 12 Color:
                Blue Component: 0.8245208
                Color Space: sRGB
                Green Component: 0.6105703
                Red Component: 0.4368615
              Ansi 13 Color:
                Blue Component: 0.4964534
                Color Space: sRGB
                Green Component: 0.3234674
                Red Component: 0.8150991
              Ansi 14 Color:
                Blue Component: 0.7783818
                Color Space: sRGB
                Green Component: 0.8322567
                Red Component: 0.5439116
              Ansi 15 Color:
                Blue Component: 0.9304831
                Color Space: sRGB
                Green Component: 0.9363679
                Red Component: 0.940678
              Background Color:
                Blue Component: 0.1294208
                Color Space: sRGB
                Green Component: 0.144692
                Red Component: 0.1564068
              Bold Color:
                Blue Component: 0.668559
                Color Space: sRGB
                Green Component: 0.7829112
                Red Component: 0.8675972
              Cursor Color:
                Blue Component: 0.8470588
                Color Space: sRGB
                Green Component: 0.8470588
                Red Component: 0.8470588
              Cursor Text Color:
                Blue Component: 0.09411765
                Color Space: sRGB
                Green Component: 0.09411765
                Red Component: 0.09411765
              Foreground Color:
                Blue Component: 0.6542979
                Color Space: sRGB
                Green Component: 0.788487
                Red Component: 0.8654987
              Selected Text Color:
                Blue Component: 0.6696877
                Color Space: sRGB
                Green Component: 0.7855775
                Red Component: 0.8660222
              Selection Color:
                Blue Component: 0.2005484
                Color Space: sRGB
                Green Component: 0.2291871
                Red Component: 0.2502496

          Default Bookmark Guid: 978C3E4B-2AE4-49B4-AFC1-F21C19B2B74B
          New Bookmarks:
            - Guid: 978C3E4B-2AE4-49B4-AFC1-F21C19B2B74B
              ASCII Anti Aliased: yes
              AWDS Pane Directory: ""
              AWDS Pane Option: "No"
              AWDS Tab Directory: ""
              AWDS Tab Option: "No"
              AWDS Window Directory: ""
              AWDS Window Option: "No"
              Allow Title Reporting: yes
              Ambiguous Double Width: no
              Automatically Log: no
              BM Growl: yes
              Background Image Is Tiled: no
              Background Image Location: ""
              Blend: 0.3
              Blink Allowed: no
              Blinking Cursor: no
              Blur: no
              Blur Radius: 1.51375
              Character Encoding: 4
              Close Sessions On End: yes
              Columns: 120
              Command: '/usr/local/bin/fish -c \"tmux\"'
              Cursor Type: 1
              Custom Command: "Yes"
              Custom Directory: Recycle
              Default Bookmark: "No"
              Disable Printing: no
              Disable Smcup Rmcup: no
              Disable Window Resizing: yes
              Flashing Bell: no
              Hide After Opening: no
              Horizontal Spacing: 1
              Idle Code: 0
              Initial Text: ""
              Log Directory: ""
              Minimum Contrast: 0
              Mouse Reporting: yes
              Name: Default
              Non Ascii Font: DejaVuSansMonoForPowerline 15
              Non-ASCII Anti Aliased: yes
              Normal Font: Hack-Regular 15
              Option Key Sends: 2
              Prompt Before Closing 2: 2
              Right Option Key Sends: 0
              Rows: 30
              Screen: -1
              Scrollback Lines: 0
              Scrollback With Status Bar: no
              Scrollback in Alternate Screen: yes
              Send Code When Idle: no
              Set Local Environment Vars: yes
              Shortcut: ""
              Silence Bell: no
              Smart Cursor Color: yes
              Sync Title: no
              Tags:
              Terminal Type: xterm-256color
              Transparency: 0.03679965
              Triggers:
              Unlimited Scrollback: yes
              Use Bold Font: yes
              Use Bright Bold: yes
              Use Canonical Parser: no
              Use Italic Font: yes
              Vertical Spacing: 1
              Visual Bell: yes
              Window Type: 0
              Working Directory: /Users/{{ansible_ssh_user}}
              Semantic History:
                action: best editor
                editor: com.sublimetext.3
                text: ""
              Jobs to Ignore:
                - rlogin
                - ssh
                - slogin
                - telnet
                - screen
                - tmux
              Smart Selection Rules:
                - notes: Word bounded by whitespace
                  precision: low
                  regex: \S+
                - notes: C++ namespace::identifier
                  precision: normal
                  regex: ([a-zA-Z0-9_]+::)+[a-zA-Z0-9_]+
                - notes: ath
                  precision: normal
                  regex: \~?/?([[:letter:][:number:]._-]+/+)+[[:letter:][:number:]._-]+/?
                - notes: Quoted string
                  precision: normal
                  regex: '@?"(?:[^"\\\\]|\\\\.)*"'
                - notes: Java/Python include paths
                  precision: normal
                  regex: ([[:letter:][:number:]._]+\.)+[[:letter:][:number:]._]+
                - notes: mailto URL
                  precision: normal
                  regex: \bmailto:([a-z0-9A-Z_]+@)?([a-zA-Z0-9\-]+\.)*[a-zA-Z0-9\-]+\b
                - notes: Obj-C selector
                  precision: high
                  regex: '@selector\\([^)]+\\)'
                - notes: email address
                  precision: high
                  regex: \b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}\b
                - notes: HTTP URL
                  precision: very_high
                  regex: https?://([a-z0-9A-Z]+(:[a-zA-Z0-9]+)?@)?[a-z0-9A-Z]+(\.[a-z0-9A-Z]+)*((:[0-9]+)?)(/[a-zA-Z0-9;/\.\-_+%~?&@=#\(\)]*)?
                - notes: SSH URL
                  precision: very_high
                  regex: \bssh:([a-z0-9A-Z_]+@)?([a-zA-Z0-9\-]+\.)*[a-zA-Z0-9\-]+\b
                - notes: Telnet URL
                  precision: very_high
                  regex: \btelnet:([a-z0-9A-Z_]+@)?([a-zA-Z0-9\-]+\.)*[a-zA-Z0-9\-]+\b
              Keyboard Map:
                0x2d-0x40000:
                  Action: 11
                  Text: "0x1f"
                0x32-0x40000:
                  Action: 11
                  Text: "0x00"
                0x33-0x40000:
                  Action: 11
                  Text: "0x1b"
                0x34-0x40000:
                  Action: 11
                  Text: "0x1c"
                0x35-0x40000:
                  Action: 11
                  Text: "0x1d"
                0x36-0x40000:
                  Action: 11
                  Text: "0x1e"
                0x37-0x40000:
                  Action: 11
                  Text: "0x1f"
                0x38-0x40000:
                  Action: 11
                  Text: "0x7f"
                0xf700-0x220000:
                  Action: 10
                  Text: "[1;2A"
                0xf700-0x240000:
                  Action: 10
                  Text: "[1;5A"
                0xf700-0x260000:
                  Action: 10
                  Text: "[1;6A"
                0xf701-0x220000:
                  Action: 10
                  Text: "[1;2B"
                0xf701-0x240000:
                  Action: 10
                  Text: "[1;5B"
                0xf701-0x260000:
                  Action: 10
                  Text: "[1;6B"
                0xf702-0x220000:
                  Action: 10
                  Text: "[1;2D"
                0xf702-0x240000:
                  Action: 10
                  Text: "[1;5D"
                0xf702-0x260000:
                  Action: 10
                  Text: "[1;6D"
                0xf703-0x220000:
                  Action: 10
                  Text: "[1;2C"
                0xf703-0x240000:
                  Action: 10
                  Text: "[1;5C"
                0xf703-0x260000:
                  Action: 10
                  Text: "[1;6C"
                0xf704-0x20000:
                  Action: 10
                  Text: "[1;2P"
                0xf705-0x20000:
                  Action: 10
                  Text: "[1;2Q"
                0xf706-0x20000:
                  Action: 10
                  Text: "[1;2R"
                0xf707-0x20000:
                  Action: 10
                  Text: "[1;2S"
                0xf708-0x20000:
                  Action: 10
                  Text: "[15;2~"
                0xf709-0x20000:
                  Action: 10
                  Text: "[17;2~"
                0xf70a-0x20000:
                  Action: 10
                  Text: "[18;2~"
                0xf70b-0x20000:
                  Action: 10
                  Text: "[19;2~"
                0xf70c-0x20000:
                  Action: 10
                  Text: "[20;2~"
                0xf70d-0x20000:
                  Action: 10
                  Text: "[21;2~"
                0xf70e-0x20000:
                  Action: 10
                  Text: "[23;2~"
                0xf70f-0x20000:
                  Action: 10
                  Text: "[24;2~"
                0xf729-0x20000:
                  Action: 10
                  Text: "[1;2H"
                0xf729-0x40000:
                  Action: 10
                  Text: "[1;5H"
                0xf72b-0x20000:
                  Action: 10
                  Text: "[1;2F"
                0xf72b-0x40000:
                  Action: 10
                  Text: "[1;5F"
              Ansi 0 Color:
                Blue Component: 0.1294208
                Green Component: 0.144692
                Red Component: 0.1564068
              Ansi 1 Color:
                Blue Component: 0.2382512
                Green Component: 0.3876701
                Red Component: 0.8158474
              Ansi 2 Color:
                Blue Component: 0.2510209
                Green Component: 0.7399791
                Red Component: 0.5202177
              Ansi 3 Color:
                Blue Component: 0.2676881
                Green Component: 0.6686236
                Red Component: 0.9481701
              Ansi 4 Color:
                Blue Component: 0.8245208
                Green Component: 0.6105703
                Red Component: 0.4368615
              Ansi 5 Color:
                Blue Component: 0.4964534
                Green Component: 0.3234674
                Red Component: 0.8150991
              Ansi 6 Color:
                Blue Component: 0.7783818
                Green Component: 0.8322567
                Red Component: 0.5439116
              Ansi 7 Color:
                Blue Component: 0.7988065
                Green Component: 0.8157431
                Red Component: 0.8288889
              Ansi 8 Color:
                Blue Component: 0.3157758
                Green Component: 0.3737666
                Red Component: 0.4055308
              Ansi 9 Color:
                Blue Component: 0.2382512
                Green Component: 0.3876701
                Red Component: 0.8158474
              Ansi 10 Color:
                Blue Component: 0.2510209
                Green Component: 0.7399791
                Red Component: 0.5202177
              Ansi 11 Color:
                Blue Component: 0.2676881
                Green Component: 0.6686236
                Red Component: 0.9481701
              Ansi 12 Color:
                Blue Component: 0.8245208
                Green Component: 0.6105703
                Red Component: 0.4368615
              Ansi 13 Color:
                Blue Component: 0.4964534
                Green Component: 0.3234674
                Red Component: 0.8150991
              Ansi 14 Color:
                Blue Component: 0.7783818
                Green Component: 0.8322567
                Red Component: 0.5439116
              Ansi 15 Color:
                Blue Component: 0.9304831
                Green Component: 0.9363679
                Red Component: 0.940678
              Background Color:
                Blue Component: 0.1294208
                Green Component: 0.144692
                Red Component: 0.1564068
              Bold Color:
                Blue Component: 0.668559
                Green Component: 0.7829112
                Red Component: 0.8675972
              Cursor Color:
                Blue Component: 0.8470588
                Green Component: 0.8470588
                Red Component: 0.8470588
              Cursor Text Color:
                Blue Component: 0.09411765
                Green Component: 0.09411765
                Red Component: 0.09411765
              Foreground Color:
                Blue Component: 0.6542979
                Green Component: 0.788487
                Red Component: 0.8654987
              Selected Text Color:
                Blue Component: 0.6696877
                Green Component: 0.7855775
                Red Component: 0.8660222
              Selection Color:
                Blue Component: 0.2005484
                Green Component: 0.2291871
                Red Component: 0.2502496

  handlers:
    - name: restart iTerm2
      shell: killall {{item}}
      ignore_errors: yes
      with_items:
        - iTerm
